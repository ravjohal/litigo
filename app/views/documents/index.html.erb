<% if @case %>
  <ol class="breadcrumb">
    <li><%= link_to 'Cases', cases_path %></li>
    <li><%= link_to @case.name, case_path(@case) %></li>
    <li class="active">Documents</li>
  </ol>

  <%= render partial: 'shared/case_tabs' %>
<% end %>

<div id="top-custom">
<ul id="top-custom">
  <li><h3>Documents</h3></li>
  <li><%= link_to 'NEW DOCUMENT', @new_path_documents, {:class => "action-button", :id => "document_modal",  :remote => true, 'data-toggle' =>  "modal", 'data-target' => '#modal-window'}  %> </li>
    </ul>
</div>
    <div class="table-responsive">
      <table id="tasks" class="table table-striped table-hover">
        <thead>
        <tr>
          <th>Author</th>
          <th>Type</th>
          <th>Document</th>
          <th>Template</th>
          <th>Case(s)</th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
        </thead>
        <tbody>
        <% @documents.each do |document| %>
          <tr data-id="<%= document.id %>">
            <td><%= document.author %></td>
            <td><%= document.doc_type %></td>
            <td>
              <%= if !document.document_url.blank?
                  link_to document.document.file.filename, document.document_url, :class => 'dark'
                  end %></td>
            <td><%= document.created_at.strftime("%m/%d/%y %I:%M %p")  %></td>
            <td><%= document.cases.map {|c| c.name}.join(', ') %></td>
            <td><%= link_to 'Show', document_path(document), :class => 'dark' %></td>
            <td><%= link_to 'Edit', edit_document_path(document), :class => 'dark' %></td>
            <td><%= link_to 'Delete',  document,  method: :delete, data: { confirm: 'Are you sure?' }, :class => 'dark'  %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
  </div>


<div id="modal-window" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"></div>

<script type="text/javascript">
$(document).ready(function() {
  $('#document_modal').click(function(event){
    $("#modal-window").html("<%= escape_javascript(render 'documents/form', new_document: @documents_a ) %>");
  });
  var table = $('.table').dataTable({
    aoColumnDefs: [
      { 'bSortable': false, 'aTargets': [ 5,6,7 ] }
    ],
    language: {
      search: "_INPUT_",
      searchPlaceholder: "Search"
    }
  });
});
</script>